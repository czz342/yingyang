<view class="container"><block wx:if="{{$root.g0===0}}"><view class="empty-cart"><image class="empty-cart-image" src="/static/empty-cart.png" mode="aspectFit"></image><text class="empty-cart-text">购物车还是空的</text><view data-event-opts="{{[['tap',[['goShopping',['$event']]]]]}}" class="go-shopping-btn" bindtap="__e">去点餐</view></view></block><block wx:else><view class="cart-content"><view class="cart-header"><view class="cart-title">购物车</view><view data-event-opts="{{[['tap',[['showClearCartConfirm',['$event']]]]]}}" class="clear-cart" bindtap="__e">清空购物车</view></view><view class="cart-items"><block wx:for="{{$root.l0}}" wx:for-item="item" wx:for-index="index" wx:key="index"><view class="cart-item"><view class="item-left"><view data-event-opts="{{[['tap',[['toggleSelect',['$0'],[[['cartItems','',index]]]]]]]}}" class="checkbox" bindtap="__e"><view class="{{['checkbox-inner',(item.$orig.selected)?'selected':'']}}"></view></view></view><image class="item-image" src="{{item.$orig.image}}" mode="aspectFill" data-event-opts="{{[['tap',[['navigateToDish',['$0'],[[['cartItems','',index,'id']]]]]]]}}" bindtap="__e"></image><view class="item-info"><text data-event-opts="{{[['tap',[['navigateToDish',['$0'],[[['cartItems','',index,'id']]]]]]]}}" class="item-name" bindtap="__e">{{item.$orig.name}}</text><block wx:if="{{item.g1}}"><text class="item-tags">{{item.g2}}</text></block><view class="item-nutrition"><text class="nutrition-text">{{"热量: "+item.$orig.calories+"kcal"}}</text><text class="nutrition-text">{{"蛋白质: "+item.$orig.nutrition.protein}}</text></view><view class="item-bottom"><text class="item-price">{{"¥"+item.$orig.price}}</text><view class="quantity-control"><view data-event-opts="{{[['tap',[['decreaseQuantity',['$0'],[[['cartItems','',index]]]]]]]}}" class="quantity-btn minus" bindtap="__e">-</view><text class="quantity">{{item.$orig.quantity}}</text><view data-event-opts="{{[['tap',[['increaseQuantity',['$0'],[[['cartItems','',index]]]]]]]}}" class="quantity-btn plus" bindtap="__e">+</view></view></view></view></view></block></view><block wx:if="{{hasSelectedItems}}"><view class="nutrition-summary"><view class="summary-header"><text class="summary-title">营养摄入总量</text></view><view class="nutrition-bars"><view class="nutrition-bar"><view class="bar-label"><text>热量</text><text>{{totalCalories+"kcal"}}</text></view><view class="bar-container"><view class="bar-progress" style="{{'width:'+(caloriesPercentage+'%')+';'+('background-color:'+(caloriesWarning?'#ff5000':'#4CAF50')+';')}}"></view></view><block wx:if="{{caloriesWarning}}"><text class="bar-warning">超出推荐值</text></block></view><view class="nutrition-bar"><view class="bar-label"><text>蛋白质</text><text>{{totalProtein}}</text></view><view class="bar-container"><view class="bar-progress" style="{{'width:'+(proteinPercentage+'%')+';'+('background-color:'+(proteinWarning?'#ff5000':'#4CAF50')+';')}}"></view></view><block wx:if="{{proteinWarning}}"><text class="bar-warning">超出推荐值</text></block></view><view class="nutrition-bar"><view class="bar-label"><text>碳水化合物</text><text>{{totalCarbs}}</text></view><view class="bar-container"><view class="bar-progress" style="{{'width:'+(carbsPercentage+'%')+';'+('background-color:'+(carbsWarning?'#ff5000':'#4CAF50')+';')}}"></view></view><block wx:if="{{carbsWarning}}"><text class="bar-warning">超出推荐值</text></block></view><view class="nutrition-bar"><view class="bar-label"><text>脂肪</text><text>{{totalFat}}</text></view><view class="bar-container"><view class="bar-progress" style="{{'width:'+(fatPercentage+'%')+';'+('background-color:'+(fatWarning?'#ff5000':'#4CAF50')+';')}}"></view></view><block wx:if="{{fatWarning}}"><text class="bar-warning">超出推荐值</text></block></view></view></view></block></view></block><block wx:if="{{$root.g3>0}}"><view class="bottom-bar"><view data-event-opts="{{[['tap',[['toggleSelectAll',['$event']]]]]}}" class="select-all" bindtap="__e"><view class="checkbox"><view class="{{['checkbox-inner',(allSelected)?'selected':'']}}"></view></view><text class="select-all-text">全选</text></view><view class="price-info"><view class="total-price-line"><text class="total-label">合计:</text><text class="total-price">{{"¥"+$root.g4}}</text></view><text class="delivery-info">不含配送费</text></view><view data-event-opts="{{[['tap',[['checkout',['$event']]]]]}}" class="{{['checkout-btn',(!hasSelectedItems)?'disabled':'']}}" bindtap="__e">{{'去结算 ('+selectedCount+')'}}</view></view></block><block wx:if="{{showWarningDialog}}"><view class="warning-dialog"><view class="warning-content"><view class="warning-header"><text class="warning-title">营养摄入提醒</text></view><view class="warning-body"><text class="warning-text">您的餐品营养摄入存在以下情况：</text><view class="warning-items"><block wx:if="{{caloriesWarning}}"><text class="warning-item">{{"热量: 超出推荐值 "+$root.g5+" kcal"}}</text></block><block wx:if="{{proteinWarning}}"><text class="warning-item">{{"蛋白质: 超出推荐值 "+$root.m0+''}}</text></block><block wx:if="{{carbsWarning}}"><text class="warning-item">{{"碳水化合物: 超出推荐值 "+$root.m1+''}}</text></block><block wx:if="{{fatWarning}}"><text class="warning-item">{{"脂肪: 超出推荐值 "+$root.m2+''}}</text></block></view><text class="warning-suggestion">建议: 您可以调整餐品搭配，以达到更均衡的营养摄入。</text></view><view class="warning-actions"><view data-event-opts="{{[['tap',[['closeWarningDialog',['$event']]]]]}}" class="warning-btn cancel" bindtap="__e">调整餐品</view><view data-event-opts="{{[['tap',[['proceedCheckout',['$event']]]]]}}" class="warning-btn confirm" bindtap="__e">继续结算</view></view></view></view></block></view>